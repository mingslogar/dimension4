using System;
using System.Runtime.InteropServices;

namespace Daytimer.Fundamentals
{
	class Interop
	{
		[StructLayout(LayoutKind.Sequential)]
		internal struct RECT
		{
			public int left;
			public int top;
			public int right;
			public int bottom;
		}

		[StructLayout(LayoutKind.Sequential)]
		internal struct APPBARDATA
		{
			public int cbSize;
			public IntPtr hWnd;
			public int uCallbackMessage;
			public int uEdge;
			public RECT rc;
			public IntPtr lParam;
		}

		internal enum ABMsg : int
		{
			ABM_NEW = 0,
			ABM_REMOVE,
			ABM_QUERYPOS,
			ABM_SETPOS,
			ABM_GETSTATE,
			ABM_GETTASKBARPOS,
			ABM_ACTIVATE,
			ABM_GETAUTOHIDEBAR,
			ABM_SETAUTOHIDEBAR,
			ABM_WINDOWPOSCHANGED,
			ABM_SETSTATE
		}

		internal enum ABNotify : int
		{
			ABN_STATECHANGE = 0,
			ABN_POSCHANGED,
			ABN_FULLSCREENAPP,
			ABN_WINDOWARRANGE
		}

		[DllImport("SHELL32", CallingConvention = CallingConvention.StdCall)]
		internal static extern uint SHAppBarMessage(int dwMessage, ref APPBARDATA pData);

		[DllImport("User32.dll", CharSet = CharSet.Auto)]
		internal static extern int RegisterWindowMessage(string msg);
	}
}
